document.addEventListener('DOMContentLoaded', function () {
	"use strict";

	const form = document.getElementById('contact');

	function validateForm() {
		const inputs = form.querySelectorAll('input, textarea');
		let isValid = true;

		inputs.forEach(input => {
			if (input.hasAttribute('required') && !input.value.trim()) {
				isValid = false;
				alert(input.name + ' is required.');
			}
			if (input.getAttribute('minlength') && input.value.length < input.getAttribute('minlength')) {
				isValid = false;
				alert(input.name + ' is too short.');
			}
			if (input.type === 'email' && !input.value.match(/^\S+@\S+\.\S+$/)) {
				isValid = false;
				alert('Please enter a valid email address.');
			}
		});

		return isValid;
	}

	form.addEventListener('submit', function (e) {
		e.preventDefault();

		if (validateForm()) {
			const formData = new FormData(form);

			fetch('php/process.php', {
				method: 'POST',
				body: new URLSearchParams(formData)
			})
			.then(response => {
				if (response.ok) {
					form.querySelectorAll(':input').forEach(input => input.setAttribute('disabled', 'disabled'));
					form.style.opacity = 0.15;
					document.getElementById('success').style.display = 'block';
				} else {
					throw new Error('Network response was not ok.');
				}
			})
			.catch(error => {
				form.style.opacity = 1;
				document.getElementById('error').style.display = 'block';
			});
		}
	});
});